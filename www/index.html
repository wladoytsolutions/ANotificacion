<!DOCTYPE html>

<html>
    <head>
       <meta charset="utf-8"> 
        <meta http-equiv="Content-Security-Policy" content="default-src 'self' data: gap: https://ssl.gstatic.com 'unsafe-eval'; style-src 'self' 'unsafe-inline'; media-src *">
        <meta name="format-detection" content="telephone=no">
        <meta name="msapplication-tap-highlight" content="no">
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width">
        <script src="js/jquery-2.1.3.min.js"></script>
        <link rel="stylesheet" type="text/css" href="css/bootstrap.css">
        <title>plugin notificaciones push</title>
    </head>
    <body>
        <div class="panel panel-info">
            <div class="panel-heading">Datos Notificacion</div>
            <div class="panel-body">
                <table id="tb_datos" class="table table-bordered">
                    <tr>
                        <td>ID registro:</td>
                        <td><label id="num_reg"></label></td>
                    </tr>
                      <tr>
                        <td>Se registro en el servidor ?:</td>
                        <td><label id="res_server"></label></td>
                    </tr>
                    <tr>
                        <td>Propiedad</td>
                        <td>Respuesta Recibida</td>
                    </tr>
                    <tr>
                        <td>TÃ­tulo :</td>
                        <td><label id="lb_tit"></label></td>
                    </tr>
                    <tr>
                        <td>Msj :</td>
                        <td><label id="lb_msj"></label></td>
                    </tr>
                    <tr>
                        <td>Url img :</td>
                        <td><label id="lb_img"></label></td>
                    </tr>
                    <tr>
                        <td>Url tono :</td>
                        <td><label id="lb_tono"></label></td>
                    </tr>
                </table>
                <label class="control-label" id="er"></label>
            </div>
           
        </div>
        <script type="text/javascript" src="cordova.js"></script>
        <script>
            document.addEventListener('deviceready',onDeviceReady,false);
            var id=null;

            function onDeviceReady(){
                  var push = PushNotification.init({"android": {
                        "senderID": "964841478681",
                        "sound": true, 
                        "forceShow": true,
                        "vibrate": true
                    }
                });

                   push.on('registration', function(data) {
                    id=data.registrationId;
                    document.getElementById("num_reg").innerHTML = id;
                    registrarIdRecibido(data.registrationId);
                });

                   push.on('notification', function(data) {
                        document.getElementById("lb_tit").innerHTML=data.title;
                        document.getElementById("lb_msj").innerHTML=data.message;
                        document.getElementById("lb_tono").innerHTML=data.sound;
                        document.getElementById("lb_img").innerHTML=data.image;   
                });


                push.on('error', function(e) {
                    $('#er').text("err: "+e.message);
                });

            }

            function registrarIdRecibido(id){
				$.post('http://192.168.1.35/ejemplows/registro.php',{
					Id_device 		: id
				}, 
				function(response) {
					alert(''+response);
				}).done(function(response) {
			
				});	
            }





        </script>

    </body>
</html>
